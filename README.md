# nlp_project

# Программа анализа тональности оценочного слова/коллокации

### Тренировочные данные
Размеченный корпус о ресторанах с DialogEvaluation 2015 года
* 'SentiRuEval_rest_markup_train.xml'
* 'SentiRuEval_rest_markup_test.xml'

### Использованные методы
* Модель с RusVectores Word2Vec ('web_0_300_20.bin' и 'ruscorpora_1_300_10.bin')
* Реализация моделей ExtraTreesClassifier, LogisticRegression, RandomForest, DecissionTree в Sklearn 

### Как запускать:
- На вход модулю поступаем массив коллокаций в формате ['отличный выбор', 'не советуем', 'очень советуем', 'очень дорого']
- На выходе датаврейм с двум колонками: collocation и polarity

### Описание работы программы
- Берется модель из  RusVectores и с ее помощью векторизуются terms (векторизуется каждое слово в коллокации и потом берется средний вектор)
- Дальше на этих векторах и их полярностях обучаю разные модели

### Результат
На выходе - результат работы нескольких моделей (ExtraTreesClassifier, LogisticRegression, RandomForest, DecissionTree) + результат классификации в формате выражение:полярность

### Интерпретация результатов:
- 'web_0_300_20.bin' работает лучше, чем 'ruscorpora_1_300_10.bin'
- Лучше делать корпус сбалансированным (позитивных примеров изначально в раз 10 больше, чем негативных)
- При разных параметрах разные модели показывают лучшие результаты
- В целом на тестовой выборке результаты PR и R около 90, но на них нельзя особо опираться, потому что всего корпус 150 + 150 термов, разбит в соотношении 0,1 тестовый к 0,9 обучающий (примеров так мало, что я решила обучать на как можно большем количестве)

### Пример классификации (RandomForest, web model):
- отличный выбор : positive
- не советуем : negative
- очень советуем : negative
- очень дорого : negative
- выше всяких похвал : negative
- в общем прекрасно : positive
- нам все понравилось : negative
- в целом ничего : positive
- отвратительный : negative
- быстро : positive
- очень плохое обслуживание : negative
- отличное меню : positive
- хороший : positive
- вкусный : positive
- замечательный : positive
- приятный : positive
- красивый : positive
- отличный : positive


# Модель, использующая word2vec.

### Используемые модели:

1) Первая модель взята из RusVectores.

Корпус интернет текстов за декабрь 2014.
Объем: 900 миллионов слов, 267 540 лемм.
Минимальная частота: 30
Используемый алгоритм: Continuous Bag-of-Words
Размерность вектора: 300

Модель была выбрана по идеалогическому принципу (корпус интернет текстов должен быть ближе к ресторанным отзывам) и сравнена с моделью ruscorpora, которая работает хуже, чем модель веб-корпуса.

2) Вторая модель обучена нами.

Модель обучена на объединении данных 'SentiRuEval_rest_markup_train.xml' и 'SentiRuEval_rest_markup_test.xml'.
Размер вектора: 1000
Ширина окна: 3
Минимальная частота: 1
Используемый алгоритм: SkipGram

Модель была выбрана подгоном ключевых параметров с ориентацией на результат.

### Описание программы:

Обученная модель берет на вход предложенные нам изначально оценочные слова:

Positive: хороший, вкусный, замечательный, приятный, красивый, отличный
Negative: плохой, ужасный, худший, неприятный

И выдает 20 самых близких к ним слов. Таким образом мы расширяем словарь положительных и отрицательных оценочных слов.

### Результаты:

Способ оценивания - интроспекция.

Модель, обученная нами, показала гораздо более низкое качество по сравнению с моделью веб-корпуса.
Поэтому было решено остановиться на модели веб-корпуса для выделения оценочных слов.

#### Модель на веб-корпусе:
POSITIVE
 [['красивый', 'positive'], ['отменный', 'positive'], ['штрудель', 'positive'], ['порадовать', 'positive'], ['обалденный', 'positive'], ['пахлава', 'positive'], ['вкусно', 'positive'], ['плохой', 'positive'], ['веселый', 'positive'], ['достойный', 'positive'], ['интересный', 'positive'], ['незабываемый', 'positive'], ['освежающий', 'positive'], ['милый', 'positive'], ['замечательный', 'positive'], ['приятный', 'positive'], ['аппетитно', 'positive'], ['комфортный', 'positive'], ['дессерт', 'positive'], ['элегантный', 'positive'], ['первоклассный', 'positive'], ['неплохой', 'positive'], ['уютный', 'positive'], ['превосходный', 'positive'], ['чудесный', 'positive'], ['изящный', 'positive'], ['оладушка', 'positive'], ['красиво', 'positive'], ['свиной::рулька', 'positive'], ['вкуснющий', 'positive'], ['прелестный', 'positive'], ['добротный', 'positive'], ['отличный', 'positive'], ['великолепный', 'positive'], ['престижный', 'positive'], ['десерт', 'positive'], ['безупречный', 'positive'], ['аппетитный', 'positive'], ['радостный', 'positive'], ['прятный', 'positive'], ['яркий', 'positive'], ['хороший', 'positive'], ['приятно', 'positive'], ['бесподобный', 'positive'], ['эффектный', 'positive'], ['смузи', 'positive'], ['роскошный', 'positive'], ['непревзойденный', 'positive'], ['удачный', 'positive'], ['необыкновенный', 'positive'], ['шикарный', 'positive'], ['вкуснотища', 'positive'], ['восхитительный', 'positive'], ['удивительный', 'positive'], ['нежный', 'positive'], ['изумительный', 'positive'], ['дружелюбный', 'positive'], ['равиоли', 'positive'], ['необычный', 'positive'], ['симпатичный', 'positive'], ['романтичный', 'positive'], ['приличный', 'positive'], ['грациозный', 'positive'], ['вкуснятина', 'positive'], ['потрясающий', 'positive'], ['оригинальный', 'positive'], ['вкусный', 'positive'], ['кисленький', 'positive'], ['любимый', 'positive'], ['неприятный', 'positive'], ['стильный', 'positive'], ['идеальный', 'positive'], ['ароматный', 'positive'], ['сытный', 'positive'], ['привлекательный', 'positive'], ['потрясать', 'positive'], ['бархатистый', 'positive'], ['легкий', 'positive'], ['супер', 'positive'], ['невкусный', 'positive'], ['очаровательный', 'positive'], ['прекрасный', 'positive'], ['салатик', 'positive'], ['овощной::рагу', 'positive']]
NEGATIVE
 [['дерьмовый', 'negative'], ['неэстетичный', 'negative'], ['тягостный', 'negative'], ['паршивый', 'negative'], ['портить', 'negative'], ['омерзительный', 'negative'], ['неподходящий', 'negative'], ['мерзкий', 'negative'], ['приятный', 'negative'], ['вообще', 'negative'], ['малоприятный', 'negative'], ['хреновый', 'negative'], ['невыносимый', 'negative'], ['неприятно', 'negative'], ['ужасающий', 'negative'], ['неприятность', 'negative'], ['дурной', 'negative'], ['ужас', 'negative'], ['душераздирающий', 'negative'], ['чудовищный', 'negative'], ['раздражение', 'negative'], ['печальный', 'negative'], ['болезненный', 'negative'], ['хороший', 'negative'], ['наоборот', 'negative'], ['странный', 'negative'], ['жуткий', 'negative'], ['мрачный', 'negative'], ['нежелательный', 'negative'], ['хорошо', 'negative'], ['отвратный', 'negative'], ['ужасать', 'negative'], ['гнусный', 'negative'], ['серьезный', 'negative'], ['страшный', 'negative'], ['неожиданный', 'negative'], ['думать', 'negative'], ['отвратительный', 'negative'], ['нехороший', 'negative'], ['ужасный', 'negative'], ['по-моему', 'negative'], ['досадный', 'negative'], ['никудышный', 'negative'], ['кошмар', 'negative'], ['испортить', 'negative'], ['расстраивать', 'negative'], ['плохо', 'negative'], ['скверный', 'negative'], ['тошнотворный', 'negative'], ['раздражать', 'negative'], ['безобразный', 'negative'], ['слабый', 'negative'], ['кошмарный', 'negative'], ['пугать', 'negative']]

#### Модель, обученная нами:
 POSITIVE
 [['вид', 'positive'], ['советовать', 'positive'], ['красивый', 'positive'], ['кафе', 'positive'], ['спокойный', 'positive'], ['ненавязчивый', 'positive'], ['ролл', 'positive'], ['год', 'positive'], ['банкет', 'positive'], ['целое', 'positive'], ['оказываться', 'positive'], ['закуска', 'positive'], ['отношение', 'positive'], ['обстановка', 'positive'], ['неплохой', 'positive'], ['большой', 'positive'], ['рекомендовать', 'positive'], ['претензия', 'positive'], ['располагать', 'positive'], ['японский', 'positive'], ['оставлять', 'positive'], ['любить', 'positive'], ['прекрасный', 'positive'], ['паста', 'positive'], ['повар', 'positive'], ['сервис', 'positive'], ['обслуживание', 'positive'], ['живой', 'positive'], ['красиво', 'positive'], ['доброжелательный', 'positive'], ['понимать', 'positive'], ['понравиться', 'positive'], ['общий', 'positive'], ['лосось', 'positive'], ['вечер', 'positive'], ['персонал', 'positive'], ['интерьер', 'positive'], ['порция', 'positive'], ['свежий', 'positive'], ['брать', 'positive'], ['вино', 'positive'], ['место', 'positive'], ['порадовать', 'positive'], ['действительно', 'positive'], ['думать', 'positive'], ['ваш', 'positive'], ['качество', 'positive'], ['сюда', 'positive'], ['замечательный', 'positive'], ['хороший', 'positive'], ['домашний', 'positive'], ['еда', 'positive'], ['довольно', 'positive'], ['вкусно', 'positive'], ['рядом', 'positive'], ['стоить', 'positive'], ['достойный', 'positive'], ['это', 'positive'], ['зал', 'positive'], ['внимательный', 'positive'], ['паб', 'positive'], ['уютный', 'positive'], ['нравиться', 'positive'], ['особенно', 'positive'], ['десерт', 'positive'], ['вполне', 'positive'], ['туда', 'positive'], ['удовольствие', 'positive'], ['отличный', 'positive'], ['просто', 'positive'], ['посещение', 'positive'], ['итальянский', 'positive'], ['уютно', 'positive'], ['атмосфера', 'positive'], ['уровень', 'positive'], ['вежливый', 'positive']]
NEGATIVE
 [['взгляд', 'negative'], ['народ', 'negative'], ['удаваться', 'negative'], ['посетитель', 'negative'], ['плохой', 'negative'], ['стоять', 'negative'], ['получаться', 'negative'], ['вообще', 'negative'], ['находиться', 'negative'], ['любить', 'negative'], ['подавать', 'negative'], ['тк', 'negative'], ['сервис', 'negative'], ['сходить', 'negative'], ['уходить', 'negative'], ['понимать', 'negative'], ['особо', 'negative'], ['итог', 'negative'], ['каждый', 'negative'], ['идти', 'negative'], ['получать', 'negative'], ['именно', 'negative'], ['давно', 'negative'], ['действительно', 'negative'], ['думать', 'negative'], ['поэтому', 'negative'], ['сюда', 'negative'], ['посоветовать', 'negative'], ['знать', 'negative'], ['немного', 'negative'], ['говорить', 'negative'], ['бывать', 'negative'], ['рядом', 'negative'], ['становиться', 'negative'], ['несколько', 'negative'], ['слишком', 'negative'], ['паб', 'negative'], ['сыр', 'negative'], ['конец', 'negative'], ['какой-то', 'negative'], ['правда', 'negative'], ['любимый', 'negative'], ['вполне', 'negative'], ['ходить', 'negative']]

 
