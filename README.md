# nlp_project

sentiment_analysis
## Тренировочные данные - размеченный корпус о ресторанах с DialogEvaluation 2015 года
* 'SentiRuEval_rest_markup_train.xml'
* 'SentiRuEval_rest_markup_test.xml'

# Использованные методы:
* Модель с RusVectores Word2Vec ('web_0_300_20.bin' и 'ruscorpora_1_300_10.bin')
* Реализация моделей ExtraTreesClassifier, LogisticRegression, RandomForest, DecissionTree в Sklearn 

## Как запускать
- На вход модулю поступаем массив коллокаций в формате ['отличный выбор', 'не советуем', 'очень советуем', 'очень дорого']
- На выходе датаврейм с двум колонками: collocation и polarity

## Описание работы программы. Что вообще происходит:
- Я создаю датасет из распаршенного корпуса о ресторанах (беру terms и их sentiment, только positive/negative). 
- Я беру модель из  RusVectores и с ее помощью векторизую свои terms (векторизую каждое слово в коллокации и потом беру средний вектор)
- Дальше на этих векторах и их полярностях обучаю разные модели
- Потом на вход поступает слово, векторизуется и предсказывается моей моделью

## Результат
На выходе - результат работы нескольких моделей (ExtraTreesClassifier, LogisticRegression, RandomForest, DecissionTree) + результат классификации в формате выражение:полярность

## Немного о результатах:
- 'web_0_300_20.bin' работает лучше, чем 'ruscorpora_1_300_10.bin'
- Лучше делать корпус сбалансированным (позитивных примеров изначально в раз 10 больше, чем негативных)
- При разных параметрах разные модели показывают лучшие результаты
- В целом на тестовой выборке результаты PR и R около 90, но на них нельзя особо опираться, потому что всего корпус 150 + 150 термов, разбит в соотношении 0,1 тестовый к 0,9 обучающий (примеров так мало, что я решила обучать на как можно большем количестве)

## Пример классификации (RandomForest, web model):
отличный выбор : positive
не советуем : negative
очень советуем : negative
очень дорого : negative
выше всяких похвал : negative
в общем прекрасно : positive
нам все понравилось : negative
в целом ничего : positive
отвратительный : negative
быстро : positive
очень плохое обслуживание : negative
отличное меню : positive
хороший : positive
вкусный : positive
замечательный : positive
приятный : positive
красивый : positive
отличный : positive
